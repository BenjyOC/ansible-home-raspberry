---
- hosts: pi-01
  become: yes
  remote_user: ubuntu
  vars:
    hostname: pi-01
    ddclient_login: bracloud.services-dns
    ddclient_subdomain: home.bracloud.services
    ovh_password: !vault |
              $ANSIBLE_VAULT;1.1;AES256
              38633436306332663636373132303934663362373334303332646464313032383739666566333231
              6262616362326561356638333165613239653836373936330a393561366463383039643536356262
              30646265353530663536613966316466623365643465313566316330363937333961316432386138
              6362376436666564380a303131363764396530623630306461306133336535393333303430366237
              30643665646333306534346638326635353633666236643362623430663465393764
    postfix_sasl_username: !vault |
              $ANSIBLE_VAULT;1.1;AES256
              66393465356262333334326633316230363963653233646235346237356633363130383363653339
              3334613736363532633262643335313061353563323366330a316561316139626562636161326365
              64633664303433646264346261303534336461623861636338363561666630373632303863623637
              3333303963306234390a343939303133623462333030383439656334316634653032666438633663
              32393631333934656237346366666365643866373330356465663630343937396231
    postfix_sasl_password: !vault |
              $ANSIBLE_VAULT;1.1;AES256
              37626465323233653563353130313266356266373432386363663635316563376636303634313231
              6561643332303637663131626432653361613561393039380a363832346261633463353839666434
              30363031313033333133316566393361663631383966303863626436666464313837353138613639
              6337656231646263360a396665383436643238336138633231326363373731303166336362663032
              3139
    postfix_parameters:
      relayhost: smtp.orange.fr:587
      smtp_sasl_password_maps: hash:/etc/postfix/sasl_passwd
      inet_interfaces: localhost
      inet_protocols: all
      mynetworks:
        - 127.0.0.0/8
      smtp_sasl_auth_enable: yes
      smtp_use_tls: true
      smtp_sasl_security_options: noanonymous
    wireguard_address: 10.8.0.3
    wireguard_unmanaged_peers:
      bracloud:
        public_key: mNCvEJQrf6czbqMWZD1sYWDwDmXskWEDSPza76EAQ3o=
        allowed_ips: 10.8.0.0/24
        endpoint: bracloud.services:51820
  roles:
    - wireguard
    - base
    - ddclient
    - postfix
    - prometheus-blackbox-exporter
    - prometheus-node-exporter
    - kubectl
